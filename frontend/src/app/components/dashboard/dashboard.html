<div class="dashboard-container" [class.fullscreen]="isFullscreen">
  <!-- Header -->
  <div *ngIf="currentView !== 'presentation' && !isFullscreen" class="dashboard-header">
    <h1>Energetick√° akademie - Dashboard lektora</h1>
    <div class="header-controls">
      <span *ngIf="userInfo" class="user-info">
        V√≠tejte, {{ userInfo.username }}! ({{ userInfo.user_type }})
      </span>
      <button class="logout-btn" (click)="logout()">Odhl√°sit se</button>
    </div>
  </div>

  <!-- Loading State -->
  <div *ngIf="isLoading" class="loading">
    <p>Naƒç√≠t√°n√≠ dashboard...</p>
  </div>

  <!-- Main Content -->
  <div *ngIf="!isLoading && userInfo" class="dashboard-content">
    
    <!-- Presentation View - For Slides -->
    <div *ngIf="currentView === 'presentation'" class="presentation-view">
      <!-- Slide Presentation Component -->
      <div class="slide-presentation-wrapper">
        <app-slide-presentation 
          [currentRound]="currentRound"
          [currentRoundDetails]="currentRoundDetails"
          [externalFullscreen]="isFullscreen"
          [gameStatus]="gameStatus"
          (advanceToNextRound)="nextRound()"
          (toggleFullscreenRequest)="toggleFullscreen()"
          (scenarioFinished)="scenarioFinishedHandler()">
        </app-slide-presentation>
      </div>
    </div>

    <!-- Game View - For Day/Night Rounds -->
    <div *ngIf="currentView === 'game'" class="game-view">
      <!-- New Game Layout: Left (60%) - Right (40% Teams) -->
      <div class="game-layout">
        <!-- Left Side (60%) - Power Plants, Comment, Weather, Buildings, Disabled Sources -->
        <div class="left-column">
          <!-- Power Plants Icons Row -->
          <div class="power-plants-row">
            <div class="power-plant-icon" *ngFor="let plant of [0,1,2,3,4,5,6]; let i = index">
              <img [src]="'/icons/rework/' + (isPowerPlantAllowed(i) ? ['01_tepelna_on.svg', '02_plynova_on.svg', '03_jaderna_on.svg', '04_akumulace_on.svg', '05_vodni_on.svg', '06_vetrna_on.svg', '07_solar_on.svg'][i] : ['01_tepelna_off.svg', '02_plynova_off.svg', '03_jaderna_off.svg', '04_akumulace_off.svg', '05_vodni_off.svg', '06_vetrna_off.svg', '07_solar_off.svg'][i])" 
                   alt="Power plant icon">
            </div>
          </div>

          <!-- Scenario Comment Text -->
          <div class="scenario-comment">
            {{ scenarioComment }}
          </div>

          <!-- Weather Box -->
          <div class="weather-box" [style.background-image]="weatherBoxBackground">
            <div class="weather-box-content">
              <!-- Left Column - Weather Icon (30%) -->
              <div class="weather-icon-column">
                <div class="weather-main-icon" [innerHTML]="weatherMainIcon"></div>
              </div>
              
              <!-- Middle Column - Temperature (30%) -->
              <div class="weather-temperature-column">
                <div class="weather-temperature">{{ weatherTemperature }}</div>
              </div>

              <!-- Right Column - Weather Info (40%) -->
              <div class="weather-info-column">
                <!-- Weather Type at top -->
                <div class="weather-type">{{ weatherTypeName }}</div>
                
                <!-- Wind Row at bottom -->
                <div class="weather-wind" *ngIf="windInfo">
                  <div class="wind-icon" [innerHTML]="windIcon"></div>
                  <div class="wind-speed">{{ windSpeed }}</div>
                </div>
              </div>
            </div>
          </div>

          <!-- Buildings Info Box -->
          <div class="buildings-info-box">
            <img src="/icons/rework/ico_build.svg" alt="Buildings icon" class="buildings-icon">
            <span class="buildings-text">M≈Ø≈æete postavit a≈æ X mal√Ωch staveb.</span>
          </div>

          <!-- Disabled Sources Box -->
          <div class="disabled-sources-box">
            <span class="disabled-sources-label">Odstaven√© zdroje:</span>
            <div class="disabled-sources-icons">
              <img src="/icons/rework/ico_plyn_off.svg" alt="Gas disabled">
              <img src="/icons/rework/ico_solar_off.svg" alt="Solar disabled">
              <img src="/icons/rework/ico_vitr_off.svg" alt="Wind disabled">
            </div>
          </div>

          <!-- Special Effects Box (if any) -->
          <!-- <div *ngIf="specialEffects.length > 0" class="special-effects-box">
            <ul class="effects-list">
              <li *ngFor="let effect of specialEffects" class="effect-item">
                <div class="effect-icon">
                  <img *ngIf="effect.icon_url" [src]="effect.icon_url" alt="Effect icon">
                  <span *ngIf="!effect.icon_url" [innerHTML]="effect.icon"></span>
                </div>
                <span class="effect-text">{{ effect.text }}</span>
              </li>
            </ul>
          </div> -->
        </div>

        <!-- Right Side (40%) - All Teams in One Column -->
        <div class="teams-column">
          <div *ngFor="let board of getAllBoards()" 
               class="team-card" 
               [class.placeholder]="isBoardPlaceholder(board)">
            <!-- Left: Team Name with colored background -->
            <div class="team-name" [style.background-color]="getTeamBackgroundColor(board)">
              {{ getTeamDisplayName(board) }}
            </div>
            <!-- Right: Production and Consumption with white background -->
            <div class="team-stats">
              <div class="stat-line">
                <span class="stat-label">V√Ωroba:</span>
                <span class="stat-value">{{ board.production || 0 | number:'1.0-0' }}</span>
              </div>
              <div class="stat-line">
                <span class="stat-label">Spot≈ôeba:</span>
                <span class="stat-value">{{ board.consumption || 0 | number:'1.0-0' }}</span>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Global End-of-Scenario Confirmation Overlay -->
  <div class="end-of-scenario-overlay" *ngIf="gameFinished">
    <div class="end-dialog">
      <h2>Sc√©n√°≈ô dokonƒçen</h2>
      <p>V≈°echny kola byla odehr√°na. Chcete zobrazit statistiky nebo se vr√°tit na v√Ωbƒõr sc√©n√°≈ôe?</p>
      <div class="end-actions">
        <button class="end-btn primary" (click)="navigateToStatistics()">üìä Zobrazit statistiky</button>
        <button class="end-btn" (click)="onContinueFromStatistics()">‚Ü©Ô∏è N√°vrat na sc√©n√°≈ôe</button>
      </div>
      <small>Statistiky jsou dostupn√© tak√© pozdƒõji na str√°nce v√Ωbƒõru sc√©n√°≈ôe.</small>
    </div>
  </div>

  <!-- Floating Fullscreen Control -->
  <!-- <div class="floating-fullscreen-controls" *ngIf="currentView === 'game' || currentView === 'presentation'">
    <button 
      class="floating-fullscreen-btn" 
      (click)="toggleFullscreen()"
      [title]="isFullscreen ? 'Ukonƒçit celou obrazovku (F nebo ESC)' : 'Cel√° obrazovka (F)'">
      {{ isFullscreen ? 'üóó' : '‚õ∂' }}
    </button>
  </div> -->
</div>
